---
title: "Biometrics I"
subtitle: "STAT 240 - Fall 2025"
author: "Robert Sholl"
footer:  "[github.io/stat240_f25](https://rmshksu.github.io/stat240_f25/)"
logo: "images/logo.jpg"
format: 
  revealjs: 
    theme: slides.scss
    transition: fade
    slide-number: true
editor: visual
execute:
  freeze: auto
---

```{r}
#| include: false
library(countdown)
```

# Welcome

## About me

::::: columns
::: {.column width="50%"}
![](images/lec-1/robert2.png){fig-alt="Headshot of Robert Sholl" fig-align="center" width="300"}

<div style="text-align: center;">
  <strong>Robert Sholl</strong>
</div>

:::

::: {.column width="50%"}
-   Graduate Teaching and Research Assistant, Department of Statistics
-   Kansas Water Institute Research Fellow
-   Find out more at [my academic website](https://rmshksu.github.io)
:::
:::::

## Meet the TA

::::: columns
::: {.column width="50%"}
![](images/lec-1/phoebe.png){fig-alt="Headshot of Phoebe B. McKay" fig-align="center" width="300"}

<div style="text-align: center;">
  <strong>Phoebe B. McKay</strong>
</div>

:::

::: {.column width="50%"}
-   Distinguished Feline
-   Hobbyist spider hunter
-   Aspiring model
-   Wild cat
:::
:::::

## About you

```{r,echo=FALSE}
students=read.csv("data/students_240_f25.csv")
majors=as.data.frame(table(students$degreeProgram))
levels=as.data.frame(table(students$classLevel))
levels=data.frame(Var1=c("Freshmen","Sophomore","Junior","Senior"),
                  Freq=c(9,11,16,8))
par(mar = c(5, 10, 4, 2))
barplot(majors$Freq,
        names.arg = majors$Var1,
        horiz = TRUE,
        las = 1,
        xlim=c(0,12),
        cex.names = 0.8,
        col = "#51288899",
        main = "Degree Programs",
        xlab = "Count")
```

## About you

```{r,echo=FALSE}
par(mar = c(3, 4, 3, 1))
barplot(levels$Freq,
        names.arg = levels$Var1,
        las = 1,
        cex.names = 0.8,
        col = "#51288899",
        main = "Class Levels",
        ylab = "Count",
        ylim=c(0,20))
```

# Admin Stuff

## What is this course?

::: incremental
-   Introductory stats for the biological sciences
-   (Ideally) comprehensive enough to be your last stats class
-   Broad enough to help you continue learning stats after
-   There will be math, arithmetic doesn't matter
-   There's some programming, none of it is required
:::

## Basic logistics

::: incremental
-   Class hours: M/W/F 11:30 AM - 12:20 PM
    -   Come late or leave early, just be respectful
    -   Attendance isn't required
-   Office hours: M/W 10:20 AM - 11:20 AM
    -   Use them
-   Stat Help Lab: M-F 9 AM - 5 PM 
    -   Starts second week of the semester
    -   My hours are Friday 9 AM - 11 AM
:::

## FAQs

::: incremental
- **Are there any pre-requisites?**
  - No, but high school algebra and biology would be helpful
- **Will we use computer programs like Excel or Python?**
  - I'll use R, you're welcome to try it, but the class is taught using "paper and pencil" mathematics
- **Is there a required textbook?**
  - "Yes", but it's free. You can find it in Canvas or the course website
:::


# Course Overview

## Exams

::: incremental
- 3 exams, all of them are "comprehensive"
- In-class, 50 minutes
  - Calculator + pencil
  - Cheat sheet (front and back)
- All exam and due dates are subject to change
- Exams will cover the material we've learned in class
  - If I don't get to it I won't test on it
:::

## Unit Question Banks

::: incremental
- 1 bank for each unit, 50 problems per bank
  - Choose 10 and write down your answers 
  - Work is not required
- Pass/fail — no partial credit
  - Turn in worked solutions after any class or during office hours. I'll provide feedback with no penalty.
:::

## Unit Question Banks

::: incremental
- Each correct answer is 1% of your grade, 30% total
- You can complete the remaining 40 per unit for 0.5 points on your exam per question
  - You must show **all work** to get credit
  - The extra credit you can get from this is up to 12% of your total grade
- 10 problem answers are due the Friday before the exam
- The remaining 40 problems are due the week of the exam 
:::

## Final Report

::: {.incremental .spaced}
- 10% of your grade, due 3 weeks before finals
- Meant to be a chance to get a "real life" experience with stats
- 3 options for the report, choose 1

  ::: callout-important
  If you're doing undergraduate research or have a different proposal — talk to me, we can see if that is a viable replacement.
  :::

:::



## Attend a talk (or conference)

::: {.small}

Attend a scientific talk (on or off campus) then write a paper with the following:

2-3 sentences summarizing the talk.

2-3 sentences about how you felt about the talk and the speaker.

1-2 sentences describing anything you learned.

1-2 sentences describing anything you didn’t understand or were unsure about.

2-3 sentences either (a) describing any statistical methods that were used/mentioned or (b) describing any statistical methods that could be applicable to the topic discussed.

:::

## Interview a pro

Talk to someone who does research or uses statistics regularly as part of their job. They can be an academic, industry, or government professional. Ask them about their education in statistics, how they use statistics, and how they view statistics in relation to their profession. Summarize the discussion, anything you learned from it, and anything you recognized from this course during the discussion in 4-8 sentences at most.

## Perform an analysis

Using R programming, complete an analysis of either (a) pre-selected data provided in Canvas or (b) outside data you selected that has been approved by the instructor. The analysis should include:

- All basic summary statistics discussed during the course.

- At least two graphics from class.

- A linear model or hypothesis test

::: {.small}

Provide all your source code, with every line of code commented, and a brief statement about what can be concluded from the analysis.

:::

## Course learning objectives

::: {.small}

By the end of this course, students will have a basic grasp of:

:::

- Graphical tools for data analysis

- Sampling methods for observational studies

- The design of experiments

- Probability and distribution theory

- Simple linear regression

- Uncertainty quantification

- t-tests for statistical hypotheses

## How to Succeed

::: incremental
- My philosophy on grades

- You have to set the pace

- Do the readings before class

- Come to class with questions

- Follow along when I work on exercises/problems

- Do every question in the 3 unit question banks

- Start thinking about your final report now

  - Start doing it in 4 weeks
  
:::

## Grading 

| Item                  | Percentage   |
|-----------------------|--------------|
| Unit 1 Problems       | 10%          |
| Unit 2 Problems       | 10%          |
| Unit 3 Problems       | 10%          |
| Final Report          | 10%          |
| Exam  1               | 20%          |
| Exam  2               | 20%          |
| Exam  3               | 20%          |
| Total                 | 100%         |

## Communication

>During business hours I will response to emails or Canvas messages within 2 business days at most, this includes messages sent outside of business hours. Response times will vary throughout the semester. If I have not responded within 2 business days feel free to contact me again or approach me directly after class/during office hours. 

>Full class communications will occur via Canvas and in-class announcements.


## AI and Academic Dishonesty

::: incremental
- Cheating is an economic issue, talk to me and we can work on a solution
  - If you cheat I will take it out on you (give you an incomplete and make you run it back)
- The syllabus outlines my AI policy in detail
- Don't use AI to replace knowledge work
  - If you don't know whether or not you're doing that **talk to me**
  
:::
  
## AI and Academic Dishonesty

::: incremental

- This is your one of your last chances to learn as a profession
  - Trust me, it's not the same when you're out in the real world
- I can't stop you, and if I don't catch you good job
- **Just don't cheat.**

:::

# Why Statistics?

## Sampling from Populations

```{r,echo=FALSE,fig.align='center'}
hobbies_M=data.frame(Hobbies=c("Reading","Foreign Languages","Playing Instruments",
                     "Cooking","Woodworking","Painting","Writing",
                     "Gardening","Swimming","Photography","Astronomy","Hiking",
                     "Archery","Blacksmithing","Traveling"),
                     Perc=c(98.2,95.6,95.4,95.1,94.4,94.1,93.8,93.8,
                            92.8,90.5,90.5,90.0,89.5,88.2,87.9))
hobbies_L=data.frame(Hobbies=c("Comic Books","Cosplay","Debating","Drinking","MTG","Anime",
                               "Makeup","Crypto","Cigars","Clubbing","Marijuana","Funko",
                               "Arguing Online","Porn","Gambling","Manosphere"),
                     Perc=c(33.6,32.1,30.5,29.0,28.5,27.4,24.4,23.1,
                            22.3,20.0,15.9,12.3,12.3,10.8,6.4,3.1))

par(mar = c(5, 8, 4, 2))
mp1=barplot(hobbies_M$Perc,
        names.arg = hobbies_M$Hobbies,
        horiz = TRUE,
        las = 1,
        cex.names = 0.8,
        col = "steelblue",
        xlim = c(0, 112),
        main = "Most Attractice Male Hobbies",
        xlab = "Percentage labeled 'Attractive'")

text(x = hobbies_M$Perc + 2,
     y = mp1,
     labels = paste0(hobbies_M$Perc, "%"),
     cex = 0.8, pos = 4)
```

## Sampling from Populations

```{r,echo=FALSE,fig.align='center'}
par(mar = c(5, 8, 4, 2))
mp2=barplot(hobbies_L$Perc,
        names.arg = hobbies_L$Hobbies,
        horiz = TRUE,
        las = 1,
        cex.names = 0.8,
        col = "tomato",
        xlim = c(0, 100),
        main = "Least Attractive Male Hobbies",
        xlab = "Percentage labeled 'Attractive'")

text(x = hobbies_L$Perc + 2,
     y = mp2,
     labels = paste0(hobbies_L$Perc, "%"),
     cex = 0.8, pos = 4)
```

## Sampling from Populations


- This sample arises from "Date Psychology", which is two people named Alexander and Caitlin
  
>"Alexander holds a MSc in Cognitive and Behavioral Neuroscience and a BA in Psychology, summa cum laude. Caitlin holds a BA in Psychology, cum laude. Together they share interests in human behavior, cognitive psychology, neuroscience, and romantic relationships."


## Sampling from Populations

::: incremental

- Study design was a "forced choice" survey of $74$ hobbies

  - Women were asked if the hobby was attractive or not
  
  - Men were asked if they thought the hobby was attractive to women or not

- Self reported study limitations

  - Convenience sample, $814$ participants, $48\%$ women
  
  - $45\%$ of of women held a Master's or higher
  
  - $>90\%$ white respondents
  
  - '...we don't expect much political ideological bias.'

:::

## Prediction

::: {.small}
>On July $30^{th}$ this year the sixth largest recorded earthquake hit the east coast of Russia and triggered a tsunami that caused $>2$ million people to be evacuated from Pacific coastlines worldwide. There was $1$ recorded death due to these events.

:::

::: incremental

- Under-studied field, there's data on earthquakes and tsunamis but not a lot for extreme events

- High magnitude earthquakes tend to result in tsunamis

  - Tsunamis are bad
  
- *Can we predict the wave height?*

:::

## Prediction

```{r message=FALSE, warning=FALSE, include=FALSE}
tsunami=read.table('data/tsunami.tsv',T,'\t')
tsunami=tsunami[-1,]
tsunami=tsunami[,-1]
tsunami=data.frame(year=tsunami$Year,
                   month=tsunami$Mo,
                   country=tsunami$Country,
                   lat=tsunami$Latitude,
                   long=tsunami$Longitude,
                   valid=tsunami$Tsunami.Event.Validity,
                   cause=tsunami$Tsunami.Cause.Code,
                   magnitude=tsunami$Earthquake.Magnitude,
                   wave_height=tsunami$Maximum.Water.Height..m.)
tsunami=subset(tsunami,tsunami$valid>2 & tsunami$cause==1)
tsunami=na.omit(tsunami)
```

```{r,echo=FALSE,fig.align='center'}
plot(tsunami$magnitude,tsunami$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Tsunamis correlated with Earthquakes (1970-present)")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(4,9,1),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000090")
```

## Prediction

```{r,echo=FALSE,fig.align='center'}
plot(tsunami$magnitude,tsunami$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Tsunamis correlated with Earthquakes (1970-present)")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(4,9,1),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000020")
abline(h=mean(tsunami$wave_height),col="#f39e38",lty=2,lwd=3)
text(5.5,6,"1.655",col="#f39e38",cex=1.3)
```

## Prediction

```{r,echo=FALSE,fig.align='center'}
extreme=subset(tsunami,tsunami$magnitude>8)
plot(extreme$magnitude,extreme$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Extreme Earthquake Events")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(8.2,9,0.2),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000090")
```

## Prediction

```{r,echo=FALSE,fig.align='center'}
extreme=subset(tsunami,tsunami$magnitude>8)
plot(extreme$magnitude,extreme$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Extreme Earthquake Events")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(8.2,9,0.2),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000090")
abline(h=mean(extreme$wave_height),col="#f39e38",lty=2,lwd=3)
text(8.5,15,"9.74",col="#f39e38",cex=1.5)
```

## Prediction

```{r,echo=FALSE,fig.align='center'}
m=lm(wave_height~magnitude,extreme)
extreme=subset(tsunami,tsunami$magnitude>8)
plot(extreme$magnitude,extreme$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Extreme Earthquake Events")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(8.2,9,0.2),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000090")
abline(coef(m)[1],coef(m)[2],col="#E51F50",lwd=2)
points(8.8,26.65,col="#24394C",cex=1.4,pch=15)
text(8.86,23,"26.65",col="#24394C",cex=1.3)
```

## Prediction

```{r,echo=FALSE,fig.align='center'}
m=lm(wave_height~magnitude,tsunami)
plot(tsunami$magnitude,tsunami$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Tsunamis correlated with Earthquakes (1970-present)")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(4,9,1),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000010")
abline(coef(m)[1],coef(m)[2],col="#E51F50",lwd=2)
points(8.8,coef(m)[1]+coef(m)[2]*8.8,col="#24394C",cex=2,pch=15)
text(8.7,13,"6.18",col="#24394C",cex=1.5)
```

## Prediction

```{r,echo=FALSE,fig.align='center',message=FALSE}
m=lm(wave_height~poly(magnitude,7),data=tsunami)
plot(tsunami$magnitude,tsunami$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Tsunamis correlated with Earthquakes (1970-present)")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(4,9,1),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000010")
points(sort(tsunami$magnitude),sort(m$fitted.values),type="l",lwd=2,col="#E51F50")
points(8.8,20,col="#24394C",cex=1.6,pch=15)
text(8.65,24,"20",col="#24394C",cex=1.5)
```

## Prediction

```{r,include=FALSE}
library(gbm)
set.seed(73)
m=gbm(wave_height~magnitude,data=tsunami,n.trees=100000,shrinkage=0.001,bag.fraction=0.35)
```

```{r,echo=FALSE,fig.align='center',message=FALSE}
plot(tsunami$magnitude,tsunami$wave_height,xlab="Earthquake Magnitude",ylab="Wave Height (Meters)",main="Tsunamis correlated with Earthquakes (1970-present)")
abline(h=seq(0,50,10),col="#D1D1D1")
abline(v=seq(4,9,1),col="#D1D1D1")
points(tsunami$magnitude,tsunami$wave_height,pch=20,cex=1.2,col="#00000010")
points(sort(tsunami$magnitude),sort(m$fit),type="l",lwd=2,col="#E51F50")
points(8.8,12,col="#24394C",cex=1.6,pch=15)
text(8.7,16.5,"12",col="#24394C",cex=1.5)
```

## Probability

::: {.small}

>Norovirus is the leading cause of gastroenteritis worldwide. It has a terrifying rate of transmission and outbreaks often occur during densely packed social events/gatherings. Anywhere theres frequent direct contact between large groups of people in an enclosed environment, there's norovirus. 

:::

::: incremental

- The perfect environment for norovirus outbreaks?

  - Cruise ships
  
  - The CDC tracks cruise ship norovirus cases separately as part of the Vessel Sanitation Program (VSP)
  
- *What are the chances you get sick if you get on a cruise ship?*

:::

## Probability

```{r,echo=FALSE,fig.align='center',message=FALSE}
cruise=read.csv("data/cruisedata.csv")
pop=cruise$total_population
infect=cruise$infected
par(mar=c(4,4,3.5,2))
plot(cruise$total_population,cruise$infected,xlab="Total Passengers",ylab="Positive Cases",
     main="Cruise Ship Norovirus Outbreaks",type="n",xlim=c(250,8500),ylim=c(5,700))
abline(h=0,col="#D1D1D1")
abline(h=100,col="#D1D1D1")
abline(h=200,col="#D1D1D1")
abline(h=300,col="#D1D1D1")
abline(h=400,col="#D1D1D1")
abline(h=500,col="#D1D1D1")
abline(h=600,col="#D1D1D1")
abline(h=700,col="#D1D1D1")
abline(v=1000,col="#D1D1D1")
abline(v=2000,col="#D1D1D1")
abline(v=3000,col="#D1D1D1")
abline(v=4000,col="#D1D1D1")
abline(v=5000,col="#D1D1D1")
abline(v=6000,col="#D1D1D1")
abline(v=7000,col="#D1D1D1")
abline(v=8000,col="#D1D1D1")
points(cruise$total_population,cruise$infected,pch=20,col="#00000090",cex=1.5)
```

## Probability

```{r,echo=FALSE,fig.align='center',message=FALSE}
cruise=read.csv("data/cruisedata.csv")
pop=cruise$total_population
infect=cruise$infected
par(mar=c(4,4,3.5,2))
plot(cruise$total_population,cruise$infected_proportion,xlab="Total Passengers",
     ylab="Positive Cases",main="Cruise Ship Norovirus Outbreaks",
     type="n",xlim=c(250,8500),ylim=c(0.01,0.24))
abline(h=seq(0.05,0.20,0.05),col="#D1D1D1")
abline(v=seq(1000,8000,1000),col="#D1D1D1")
points(cruise$total_population,cruise$infected_proportion,pch=20,col="#00000090",cex=1.5)
```

## Probability

```{r,echo=FALSE,fig.align='center',message=FALSE}
hist(cruise$infected_proportion,xlab="Proportion",
     main="Proportion of Positive Cases",breaks=20,col="#DDC4EE90",xlim=c(0,0.2))
```

## Probability

```{r,echo=FALSE,fig.align='center',message=FALSE}
hist(cruise$infected_proportion,xlab="Proportion",
     main="Proportion of Positive Cases",breaks=20,
     col="#DDC4EE99",xlim=c(0,0.2))
abline(v=median(cruise$infected_proportion),col="#3B4160",lwd=4,lty=2)
text(0.025,17,"0.04",col="#3B4160",cex=1.5)
```

## Probability

```{r,echo=FALSE,fig.align='center',message=FALSE}
cruise=read.csv("data/cruisedata.csv")
pop=cruise$total_population
infect=cruise$infected
bad=cruise[cruise$liner %in% names(which(table(cruise$liner) > 5)), ]
par(mar = c(5, 12, 1, 1))
boxplot(bad$infected_proportion ~ bad$liner, ,
        horizontal = TRUE,
        col = "white",
        xlab = "Proportion Infected",
        ylab = "",
        main = "",
        las = 1)
abline(v=0.04,col="#3B4160",lwd=3,lty=2)
```


## Uncertainty

>Like any good math class, we need to check our work.

::: incremental

- Are any of these conclusion right?

- What can we define as right?
  
- If they're right, how certain are we?

- If they're wrong, how wrong are they?

  - How certain of *that* are we?
  
- What do we do in either case?
  
:::

# Go away